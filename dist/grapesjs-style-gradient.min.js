/*! grapesjs-style-gradient - 1.0.5 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("grapesjs")):"function"==typeof define&&define.amd?define(["grapesjs"],t):"object"==typeof exports?exports["grapesjs-style-gradient"]=t(require("grapesjs")):e["grapesjs-style-gradient"]=t(e.grapesjs)}(this,function(e){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t,n){"use strict";function r(e,t,n){t=t.split(/\s+/);for(var r=0;r<t.length;++r)e.addEventListener(t[r],n)}function i(e,t,n){t=t.split(/\s+/);for(var r=0;r<t.length;++r)e.removeEventListener(t[r],n)}Object.defineProperty(t,"__esModule",{value:!0}),t.on=r,t.off=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(2),a=r(o),l=n(7),s=r(l),u=grapesjs||s.default;t.default=u.plugins.add("gjs-style-gradient",function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={grapickOpts:{},colorPicker:"",inputDirection:1,inputType:1},r=i({},n,t);(0,a.default)(e,r)})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o=n(3),a=function(e){return e&&e.__esModule?e:{default:e}}(o),l=void 0,s=void 0,u=function(e){return(1==e.getAlpha()?e.toHexString():e.toRgbString()).replace(/ /g,"")};t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.StyleManager,o=t.colorPicker;n.addType("gradient",{view:{events:{},templateInput:function(e){return""},setValue:function(e){var t=this.gp,n=this.model.getDefaultValue();e=e||n,t&&t.setValue(e,{silent:1}),s&&s.setValue(t.getType()),l&&l.setValue(t.getDirection())},onRender:function(){var c=this,d=this.ppfx,h=document.createElement("div"),f=o&&'<div class="grp-handler-cp-wrap">\n          <div class="'+d+'field-colorp-c">\n            <div class="'+d+'checker-bg"></div>\n            <div class="'+d+'field-color-picker" data-cp></div>\n          </div>\n        </div>',p=new a.default(i({colorEl:f},t.grapickOpts,{el:h})),v=this.el.querySelector("."+d+"fields");v.style.flexWrap="wrap",v.appendChild(h.children[0]),this.gp=p,p.on("change",function(e){var t=p.getSafeValue();c.model.setValueFromInput(t,e)}),[["inputDirection","select","setDirection",{name:"Direction",options:[{value:"top"},{value:"right"},{value:"center"},{value:"bottom"},{value:"left"}]}],["inputType","select","setType",{name:"Type",options:[{value:"radial"},{value:"linear"},{value:"repeating-radial"},{value:"repeating-linear"}]}]].forEach(function(e){var o=e[0],a=t[e[0]];if(a){var u=e[1],c="object"==(void 0===a?"undefined":r(a))?a:{},d=n.createType(c.type||u,{model:i({},e[3],c)});d.render(),d.model.on("change:value",function(t,n){p[e[2]](t.getFullValue())}),v.appendChild(d.el),"inputDirection"==o&&(l=d),"inputType"==o&&(s=d)}}),"default"==o&&(o=function(t){var n=t.getEl().querySelector("[data-cp]"),r=n.style;r.backgroundColor=t.getColor();var i=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=u(e);r.backgroundColor=i,t.setColor(i,n)};e.$(n).spectrum({showAlpha:!0,chooseText:"Ok",cancelText:"тип",color:t.getColor(),change:function(e){i(e)},move:function(e){i(e,0)}})}),o&&p.setColorPicker(o)}}})}},function(e,t,n){"use strict";var r=n(4),i=function(e){return e&&e.__esModule?e:{default:e}}(r);e.exports=function(e){return new i.default(e)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(5),c=r(u),d=n(6),h=r(d),f=n(0),p=function(e,t){return e.position-t.position},v=function(e){return e+"-gradient("},g=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));e=Object.assign({},e);var r={pfx:"grp",el:".grp",colorEl:"",min:0,max:100,direction:"90deg",type:"linear",height:"30px",width:"100%"};for(var i in r)i in e||(e[i]=r[i]);var l=e.el;if(!((l="string"==typeof l?document.querySelector(l):l)instanceof HTMLElement))throw"Element not found, given "+l;return n.el=l,n.handlers=[],n.options=e,n.on("handler:color:change",function(e,t){return n.change(t)}),n.on("handler:position:change",function(e,t){return n.change(t)}),n.on("handler:remove",function(e){return n.change(1)}),n.on("handler:add",function(e){return n.change(1)}),n.render(),n}return l(t,e),s(t,[{key:"setColorPicker",value:function(e){this.colorPicker=e}},{key:"getValue",value:function(e,t){var n=this.getColorValue(),r=e||this.getType(),i=t||this.getDirection();return n?r+"-gradient("+i+", "+n+")":""}},{key:"getSafeValue",value:function(e,t){var n=this.previewEl,r=this.getValue(e,t);if(!this.sandEl&&(this.sandEl=document.createElement("div")),!n||!r)return"";for(var o=this.sandEl.style,a=[r].concat(i(this.getPrefixedValues(e,t))),l=void 0,s=0;s<a.length&&(l=a[s],o.backgroundImage=l,o.backgroundImage!=l);s++);return o.backgroundImage}},{key:"setValue",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.type,i=this.direction,o=t.indexOf("(")+1,a=t.lastIndexOf(")"),l=t.substring(o,a),s=l.split(/,(?![^(]*\)) /);if(this.clear(n),!l)return void this.updatePreview();s.length>2&&(i=s.shift());var u=void 0;["repeating-linear","repeating-radial","linear","radial"].forEach(function(e){t.indexOf(v(e))>-1&&!u&&(u=1,r=e)}),this.setDirection(i,n),this.setType(r,n),s.forEach(function(t){var r=t.split(" "),i=parseFloat(r.pop()),o=r.join("");e.addHandler(i,o,0,n)}),this.updatePreview()}},{key:"getColorValue",value:function(){var e=this.handlers;return e.sort(p),e=1==e.length?[e[0],e[0]]:e,e.map(function(e){return e.getValue()}).join(", ")}},{key:"getPrefixedValues",value:function(e,t){var n=this.getValue(e,t);return["-moz-","-webkit-","-o-","-ms-"].map(function(e){return""+e+n})}},{key:"change",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.updatePreview(),!t.silent&&this.emit("change",e)}},{key:"setDirection",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.options.direction=e,this.change(1,t)}},{key:"getDirection",value:function(){return this.options.direction}},{key:"setType",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.options.type=e,this.change(1,t)}},{key:"getType",value:function(){return this.options.type}},{key:"addHandler",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=new h.default(this,e,t,n);return!r.silent&&this.emit("handler:add",i),i}},{key:"getHandler",value:function(e){return this.handlers[e]}},{key:"getHandlers",value:function(){return this.handlers}},{key:"clear",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.handlers,n=t.length-1;n>=0;n--)t[n].remove(e)}},{key:"getSelected",value:function(){for(var e=this.getHandlers(),t=0;t<e.length;t++){var n=e[t];if(n.isSelected())return n}return null}},{key:"updatePreview",value:function(){var e=this.previewEl;e&&(e.style.backgroundImage=this.getSafeValue("linear","to right"))}},{key:"initEvents",value:function(){var e=this,t=this.options,n=t.min,r=t.max,i=this.previewEl,o=0,a={};i&&(0,f.on)(i,"click",function(t){a.w=i.clientWidth,a.h=i.clientHeight;var l=t.offsetX-i.clientLeft,s=t.offsetY-i.clientTop;if(!((o=l/a.w*100)>r||o<n)){var u=document.createElement("canvas"),c=u.getContext("2d");u.width=a.w,u.height=a.h;var d=c.createLinearGradient(0,0,a.w,a.h);e.getHandlers().forEach(function(e){return d.addColorStop(e.position/100,e.color)}),c.fillStyle=d,c.fillRect(0,0,u.width,u.height),u.style.background="black";var h=u.getContext("2d").getImageData(l,s,1,1).data,f="rgba("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+")";e.addHandler(o,f)}})}},{key:"render",value:function(){var e=this.options,t=this.el,n=e.pfx,r=e.height,i=e.width;if(t){var o=n+"-wrapper",a=n+"-preview";t.innerHTML='\n      <div class="'+o+'">\n        <div class="'+a+'"></div>\n      </div>\n    ';var l=t.querySelector("."+o),s=t.querySelector("."+a),u=l.style;u.position="relative",this.wrapperEl=l,this.previewEl=s,r&&(u.height=r),i&&(u.width=i),this.initEvents(),this.updatePreview()}}}]),t}(c.default);t.default=g},function(e,t){function n(){}n.prototype={on:function(e,t,n){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){function r(){i.off(e,r),t.apply(n,arguments)}var i=this;return r._=t,this.on(e,r,n)},emit:function(e){var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),r=0,i=n.length;for(r;r<i;r++)n[r].fn.apply(n[r].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),r=n[e],i=[];if(r&&t)for(var o=0,a=r.length;o<a;o++)r[o].fn!==t&&r[o].fn._!==t&&i.push(r[o]);return i.length?n[e]=i:delete n[e],this}},e.exports=n},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(0),a=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"black",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;r(this,e),t.getHandlers().push(this),this.gp=t,this.position=n,this.color=i,this.selected=0,this.render(),o&&this.select()}return i(e,[{key:"toJSON",value:function(){return{position:this.position,selected:this.selected,color:this.color}}},{key:"setColor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.color=e,this.emit("handler:color:change",this,t)}},{key:"setPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.getEl();this.position=e,n&&(n.style.left=e+"%"),this.emit("handler:position:change",this,t)}},{key:"getColor",value:function(){return this.color}},{key:"getPosition",value:function(){return this.position}},{key:"isSelected",value:function(){return!!this.selected}},{key:"getValue",value:function(){return this.getColor()+" "+this.getPosition()+"%"}},{key:"select",value:function(){var e=this.getEl();this.gp.getHandlers().forEach(function(e){return e.deselect()}),this.selected=1;var t=this.getSelectedCls();e&&(e.className+=" "+t),this.emit("handler:select",this)}},{key:"deselect",value:function(){var e=this.getEl();this.selected=0;var t=this.getSelectedCls();e&&(e.className=e.className.replace(t,"").trim()),this.emit("handler:deselect",this)}},{key:"getSelectedCls",value:function(){return this.gp.options.pfx+"-handler-selected"}},{key:"remove",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getEl(),n=this.gp.getHandlers(),r=n.splice(n.indexOf(this),1)[0];return t&&t.parentNode.removeChild(t),!e.silent&&this.emit("handler:remove",r),r}},{key:"getEl",value:function(){return this.el}},{key:"initEvents",value:function(){var e=this,t=this.getEl(),n=this.gp.previewEl,r=this.gp.options,i=r.min,a=r.max,l=t.querySelector("[data-toggle=handler-close]"),s=t.querySelector("[data-toggle=handler-color-c]"),u=t.querySelector("[data-toggle=handler-color-wrap]"),c=t.querySelector("[data-toggle=handler-color]"),d=t.querySelector("[data-toggle=handler-drag]");if(s&&(0,o.on)(s,"click",function(e){return e.stopPropagation()}),l&&(0,o.on)(l,"click",function(t){t.stopPropagation(),e.remove()}),c&&(0,o.on)(c,"change",function(t){var n=t.target,r=n.value;e.setColor(r),u&&(u.style.backgroundColor=r)}),d){var h=0,f=0,p=0,v={},g={},y={},m=function(t){p=1,y.x=t.clientX-g.x,y.y=t.clientY-g.y,h=100*y.x,h/=v.w,h=f+h,h=h<i?i:h,h=h>a?a:h,e.setPosition(h,0),e.emit("handler:drag",e,h),0===t.which&&b(t)},b=function t(n){p&&(p=0,e.setPosition(h),(0,o.off)(document,"touchmove mousemove",m),(0,o.off)(document,"touchend mouseup",t),e.emit("handler:drag:end",e,h))},k=function(t){0===t.button&&(e.select(),f=e.position,v.w=n.clientWidth,v.h=n.clientHeight,g.x=t.clientX,g.y=t.clientY,(0,o.on)(document,"touchmove mousemove",m),(0,o.on)(document,"touchend mouseup",b),e.emit("handler:drag:start",e))};(0,o.on)(d,"touchstart mousedown",k),(0,o.on)(d,"click",function(e){return e.stopPropagation()})}}},{key:"emit",value:function(){var e;(e=this.gp).emit.apply(e,arguments)}},{key:"render",value:function(){var e=this.gp,t=e.options,n=e.previewEl,r=e.colorPicker,i=t.pfx,o=t.colorEl,a=this.getColor();if(n){var l=document.createElement("div"),s=l.style,u=i+"-handler";return l.className=u,l.innerHTML='\n      <div class="'+u+'-close-c">\n        <div class="'+u+'-close" data-toggle="handler-close">&Cross;</div>\n      </div>\n      <div class="'+u+'-drag" data-toggle="handler-drag"></div>\n      <div class="'+u+'-cp-c" data-toggle="handler-color-c">\n        '+(o||'\n          <div class="'+u+'-cp-wrap" data-toggle="handler-color-wrap" style="background-color: '+a+'">\n            <input type="color" data-toggle="handler-color" value="'+a+'">\n          </div>')+"\n      </div>\n    ",s.position="absolute",s.top=0,s.left=this.position+"%",n.appendChild(l),this.el=l,this.initEvents(),r&&r(this),l}}}]),e}();t.default=a},function(t,n){t.exports=e}])});